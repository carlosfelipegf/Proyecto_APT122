{% extends "base_dashboard.html" %}

{% block dashboard_menu %}
<ul class="nav flex-column">
    <li class="nav-item"><a class="nav-link active" href="{% url 'dashboard_tecnico' %}"><i class="fas fa-hammer"></i> Mis Inspecciones</a></li>
    <li class="nav-item"><a class="nav-link" href="{% url 'perfil_tecnico' %}"><i class="fas fa-user-circle"></i> Mi Perfil Profesional</a></li>
    <li class="nav-item"><a class="nav-link text-danger" href="{% url 'logout' %}"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a></li>
</ul>
{% endblock dashboard_menu %}

{% block dashboard_content %}
<h1>Bienvenido, {{ user.username|title }} (Técnico)</h1>
<p class="alert alert-info">Tu función es completar las inspecciones que te han sido asignadas.</p>

<h2>Inspecciones Pendientes o En Curso</h2>

{% if inspecciones_pendientes %}
    <div class="list-group">
        {% for inspeccion in inspecciones_pendientes %}
            <div class="list-group-item list-group-item-action flex-column align-items-start {% if inspeccion.estado == 'ASIGNADA' %}list-group-item-warning{% endif %}">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">{{ inspeccion.nombre_inspeccion }}</h5>
                    <small>Asignada el: {{ inspeccion.fecha_creacion|date:"d M Y" }}</small>
                </div>
                <p class="mb-1">Cliente: {{ inspeccion.solicitud.cliente.username }} | Maquinaria: {{ inspeccion.solicitud.maquinaria }}</p>
                <small>Estado: <span class="badge bg-primary">{{ inspeccion.get_estado_display }}</span></small>
                <a href="{% url 'completar_inspeccion' inspeccion.id %}" class="btn btn-sm btn-success float-end">
                    {% if inspeccion.estado == 'ASIGNADA' %}Iniciar Inspección{% else %}Continuar Inspección{% endif %}
                </a>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="alert alert-success mt-4">
        ¡Felicidades! No tienes inspecciones asignadas pendientes ni en curso.
    </div>
{% endif %}
{% endblock dashboard_content %}