{% extends "base.html" %}

{% block title %}Iniciar Sesión - Optifire APT{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5">
  <div class="col-md-6 col-lg-5">
    <div class="card shadow-sm p-4">
      <h2 class="text-center mb-4">Iniciar Sesión</h2>

      <!-- Mensajes desde Django -->
      {% if messages %}
        {% for m in messages %}
          <div class="alert alert-{{ m.tags|default:'danger' }}" role="alert">{{ m }}</div>
        {% endfor %}
      {% endif %}

      <!-- Mensaje de error manual -->
      {% if error_message %}
        <div class="alert alert-danger" role="alert">{{ error_message }}</div>
      {% endif %}

      <form id="loginForm" method="post" novalidate>
        {% csrf_token %}
        <div class="mb-3">
          <label for="username" class="form-label">Usuario</label>
          <input type="text" class="form-control" id="username" name="username" required
                 pattern="^[A-Za-z0-9]{4,}$"
                 title="El usuario debe tener al menos 4 caracteres y solo letras o números.">
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Contraseña</label>
          <input type="password" class="form-control" id="password" name="password" required
                 pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$"
                 title="Debe tener mínimo 8 caracteres, una mayúscula, una minúscula, un número y un carácter especial.">
        </div>

        <div id="errorMsg" class="text-danger small mb-2"></div>

        <button type="submit" class="btn btn-primary w-100">Entrar</button>
      </form>

      <p class="text-center mt-3 mb-0 text-muted small">
        ¿Olvidaste tu contraseña? <a href="{% url 'password_reset' %}" class="text-decoration-none">Recupérala aquí</a>
      </p>
    </div>
  </div>
</div>


</script>
{% endblock %}